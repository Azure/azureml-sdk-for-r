<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Building custom Docker images for training and deployment • azuremlsdk</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Building custom Docker images for training and deployment">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">azuremlsdk</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.10.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/installation.html">Install the Azure ML SDK for R</a>
    </li>
    <li>
      <a href="../articles/configuration.html">Set up an Azure ML workspace</a>
    </li>
    <li>
      <a href="../articles/train-and-deploy-first-model.html">Train and deploy your first model with Azure ML</a>
    </li>
    <li>
      <a href="../articles/train-with-tensorflow.html">Train a TensorFlow model</a>
    </li>
    <li>
      <a href="../articles/hyperparameter-tune-with-keras.html">Hyperparameter tune a Keras model</a>
    </li>
    <li>
      <a href="../articles/deploy-to-aks.html">Deploy a web service to Azure Kubernetes Service</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Guides</li>
    <li>
      <a href="../articles/building-custom-docker-images.html">Building custom Docker images for training and deployment</a>
    </li>
    <li>
      <a href="../articles/deploying-models.html">Deploying models</a>
    </li>
    <li>
      <a href="../articles/troubleshooting.html">Troubleshooting</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/azure/azureml-sdk-for-r">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Building custom Docker images for training and deployment</h1>
            
            <h4 class="date">2020-08-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/azure/azureml-sdk-for-r/blob/master/vignettes/building-custom-docker-images.Rmd"><code>vignettes/building-custom-docker-images.Rmd</code></a></small>
      <div class="hidden name"><code>building-custom-docker-images.Rmd</code></div>

    </div>

    
    
<p>This guide covers how to build and use custom Docker images for training and deploying models with Azure Machine Learning.</p>
<p>For remote training jobs and model deployments, Azure ML has a default environment that gets used. However, this default environment may not be sufficient for the requirements of your particular scenario. And if you specify additional dependencies on top of the default environment, you will have to wait through the image build process when you run the job. For these situations, we recommend that you create and use a custom Docker image. Typically, you create a custom image when you want to use Docker to manage your dependencies, maintain tighter control over component versions or save time during remote training runs or deployment. For example, you might want to standardize on a specific version of R or other component. You might also want to install software required by your training code or model, where the installation process takes a long time. Installing the software when creating the Docker image means that you don’t have to install it for each remote run or deployment.</p>
<div id="prerequisites" class="section level2">
<h2 class="hasAnchor">
<a href="#prerequisites" class="anchor"></a>Prerequisites</h2>
<ul>
<li>To build and push a Docker image, you will need to have Docker installed. One recommended option is to use an Azure Machine Learning <a href="https://docs.microsoft.com/azure/machine-learning/concept-compute-instance">compute instance</a>, which has Docker pre-installed.</li>
<li>A Docker registry, such as <a href="https://hub.docker.com/">Docker Hub</a> or <a href="https://docs.microsoft.com/azure/container-registry/">Azure Container Registry</a>, for publishing your Docker images.</li>
</ul>
</div>
<div id="writing-the-dockerfile" class="section level2">
<h2 class="hasAnchor">
<a href="#writing-the-dockerfile" class="anchor"></a>Writing the Dockerfile</h2>
<p>The first step in building a Docker image is to write the Dockerfile, a text file that contains all the commands needed to build your image. Create a text file named <code>Dockerfile</code>.</p>
<div id="choose-the-base-image" class="section level3">
<h3 class="hasAnchor">
<a href="#choose-the-base-image" class="anchor"></a>Choose the base image</h3>
<p>Most Dockerfiles start from a parent image, rather than from scratch. Azure ML has a set of maintained images that serve as base images for training and inference. You can find information on these images, including the Dockerfiles used to build them, at this GitHub repo <a href="https://github.com/Azure/AzureML-Containers">Azure/AzureML-Containers</a>. Depending on your scenario, you should pick an appropriate CPU or GPU image to use as the parent image. The base images include Miniconda, and the GPU base images include the necessary GPU drivers needed to run GPU jobs on Azure ML. <a href="https://github.com/Azure/AzureML-Containers#featured-tags">Here</a> is the list of images and associated tags for the Azure ML base images.</p>
<p>As an example, we will use one of the CPU images as the parent image for our Dockerfile:</p>
<pre><code>FROM mcr.microsoft.com/azureml/base:openmpi3.1.2-ubuntu18.04</code></pre>
</div>
<div id="specify-conda-dependencies" class="section level3">
<h3 class="hasAnchor">
<a href="#specify-conda-dependencies" class="anchor"></a>Specify conda dependencies</h3>
<p>Since using Azure ML has some Python dependencies, we will add an instruction to install these dependencies via Conda, an open-source package management system:</p>
<ol style="list-style-type: decimal">
<li>
<strong>rpy2</strong>, a package required by Azure ML for inference scenarios. If you are not building an image for deploying a web service, you do not have to include this package.</li>
<li>
<strong>mscorefonts</strong>, a fonts package needed if your remote run writes out any plots or images (e.g. with <code>ggplot2</code>).</li>
<li>
<strong>azureml-defaults</strong>, a lightweight version of the full Azure ML Python SDK that includes the <code>azureml-core</code> and <code>applicationinsights</code> packages required for tasks such as logging metrics, uploading artifacts, accessing datastores from within runs, and inference. <code>azureml-defaults</code> should be sufficient for most remote training and deployment scenarios; if for some reason you need the full SDK, you can specify pip installing the full <code>azureml-sdk</code> package instead.</li>
</ol>
<p>We will also install the R interpreter via conda:</p>
<ol start="4" style="list-style-type: decimal">
<li>
<strong>r-base</strong>, a package for specifying the R interpreter.</li>
</ol>
<p>Optionally, you can also install the <a href="https://docs.anaconda.com/anaconda/user-guide/tasks/using-r-language/">R Essentials bundle</a> <strong>r-essentials</strong>, which includes approximately 200 of the most popular R packages for data science, including dplyr, shiny, ggplot2, tidyr, caret, and nnet. For tighter control over package versions and the size of your image, however, it is better to explicitly specify each R package that you need (covered in the following section).</p>
<pre><code>FROM mcr.microsoft.com/azureml/base:openmpi3.1.2-ubuntu18.04

RUN conda install -c r -y pip=20.1.1 openssl=1.1.1c r-base rpy2 &amp;&amp; \
  conda install -c conda-forge -y mscorefonts &amp;&amp; \
    conda clean -ay &amp;&amp; \
    pip install --no-cache-dir azureml-defaults</code></pre>
<p>If you have any other Python dependencies, such as for TensorFlow or Keras, which also leverage reticulate to wrap the corresponding Python SDK like Azure ML does, you should also specify those. The following vignettes have Dockerfiles you can reference:</p>
<ul>
<li><a href="https://github.com/Azure/azureml-sdk-for-r/tree/master/vignettes/train-with-tensorflow">TensorFlow</a></li>
<li><a href="https://github.com/Azure/azureml-sdk-for-r/tree/master/vignettes/hyperparameter-tune-with-keras">Keras</a></li>
</ul>
<p><strong>NOTE:</strong></p>
<p>Although standard installation procedure for the Azure ML SDK (and TensorFlow and Keras) assumes installing the Python SDK via <code>install_azureml()</code>, you will not need to add an instruction for this in your Dockerfile (or inside your job script) since the above instruction already directly installs the Python SDK and reticulate will find the Python installation. In fact, for remote jobs on Azure ML, you should not use <code>install_azureml()</code>, as you may run into a “Permissions denied” issue with Docker running as non-root when creating the conda environment (which is what the <code>install_azureml()</code> method does).</p>
</div>
<div id="specify-r-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#specify-r-packages" class="anchor"></a>Specify R packages</h3>
<p>Finally, specify any R packages that are required for your training script or scoring script. The following example installs several R packages from CRAN.</p>
<pre><code>FROM mcr.microsoft.com/azureml/base:openmpi3.1.2-ubuntu18.04

RUN conda install -c r -y pip=20.1.1 openssl=1.1.1c r-base rpy2 &amp;&amp; \
  conda install -c conda-forge -y mscorefonts &amp;&amp; \
    conda clean -ay &amp;&amp; \
    pip install --no-cache-dir azureml-defaults
    
ENV TAR="/bin/tar"
RUN R -e "install.packages(c('remotes', 'reticulate', 'optparse', 'azuremlsdk'), repos = 'https://cloud.r-project.org/')"</code></pre>
<p>If you want to install a package from GitHub, e.g. the Azure ML R SDK, you can do the following:</p>
<pre><code>FROM mcr.microsoft.com/azureml/base:openmpi3.1.2-ubuntu18.04

RUN conda install -c r -y pip=20.1.1 openssl=1.1.1c r-base rpy2 &amp;&amp; \
  conda install -c conda-forge -y mscorefonts &amp;&amp; \
    conda clean -ay &amp;&amp; \
    pip install --no-cache-dir azureml-defaults
    
ENV TAR="/bin/tar"
RUN R -e "install.packages(c('remotes', 'reticulate', 'optparse'), repos = 'https://cloud.r-project.org/')"
RUN R -e "remotes::install_github('https://github.com/Azure/azureml-sdk-for-r')"</code></pre>
</div>
</div>
<div id="build-and-publish-the-image" class="section level2">
<h2 class="hasAnchor">
<a href="#build-and-publish-the-image" class="anchor"></a>Build and publish the image</h2>
<p>Now, build and publish your Docker image to a Docker registry. The following sections show examples for publish your image on either Docker Hub or Azure Container Registry.</p>
<p>You can familiarize yourself first with the official <a href="https://docs.docker.com/get-started/part2/">documentation</a> on building Docker images if you are new to it.</p>
<div id="publish-on-docker-hub" class="section level3">
<h3 class="hasAnchor">
<a href="#publish-on-docker-hub" class="anchor"></a>Publish on Docker Hub</h3>
<p>If you are using Docker Hub to publish your images, first create a Docker Hub account and a repository where you will publish your image. Then, run the following set of CLI commands.</p>
<ol style="list-style-type: decimal">
<li>Log in into your Docker Hub account and provide the password when prompted:</li>
</ol>
<pre><code>docker login --username &lt;your username&gt;</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Now, change your directory into the directory that contains the <code>Dockerfile</code>. Build your Docker image and tag it:</li>
</ol>
<pre><code>docker build --tag &lt;your username&gt;/&lt;your repository&gt;:&lt;tag&gt; .</code></pre>
<p>By convention, you can have your repository correspond to the image name. By default, the tag will be given the tag <code>latest</code>.</p>
<ol start="3" style="list-style-type: decimal">
<li>Once your image is built and you have verified that it is the image you want to publish, publish the image on Docker Hub:</li>
</ol>
<pre><code>docker push &lt;your username&gt;/&lt;your repository&gt;:&lt;tag&gt;</code></pre>
</div>
<div id="publish-on-azure-container-registry" class="section level3">
<h3 class="hasAnchor">
<a href="#publish-on-azure-container-registry" class="anchor"></a>Publish on Azure Container Registry</h3>
<p>The first time you train or deploy a model using an Azure Machine Learning workspace, an Azure Container Registry is created for your workspace.You can build and publish your image using this registry. (You can also use a standalone ACR registry if you prefer.)</p>
<ol style="list-style-type: decimal">
<li>First, authenticate into your Azure subscription:</li>
</ol>
<pre><code>az login</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Then, find the container registry name for your workspace:</li>
</ol>
<pre><code>az ml workspace show -w &lt;your workspace&gt; -g &lt;resourcegroup&gt; --query containerRegistry</code></pre>
<p>The information returned is similar to the following text: <code>/subscriptions/&lt;subscription_id&gt;/resourceGroups/&lt;resource_group&gt;/providers/Microsoft.ContainerRegistry/registries/&lt;registry_name&gt;</code></p>
<p>The <registry_name> value is the name of the Azure Container Registry for your workspace.</registry_name></p>
<ol start="3" style="list-style-type: decimal">
<li>Authenticate to the Azure Container Registry:</li>
</ol>
<pre><code>az acr login --name &lt;registry_name&gt;</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Change your directory into the directory that contains the <code>Dockerfile</code>. Use the following command to upload the Dockerfile and build it:</li>
</ol>
<pre><code>az acr build --image &lt;image_name&gt;:&lt;tag&gt; --registry &lt;registry_name&gt; --file Dockerfile .</code></pre>
</div>
</div>
<div id="create-an-azure-ml-environment" class="section level2">
<h2 class="hasAnchor">
<a href="#create-an-azure-ml-environment" class="anchor"></a>Create an Azure ML Environment</h2>
<p>Now that your Docker image is published, you can create an Azure ML Environment and specify your custom image.</p>
<p>For Docker Hub:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">env &lt;-<span class="st"> </span><span class="kw">r_environment</span>(<span class="st">"your-env-name"</span>,</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">                     <span class="dt">custom_docker_image =</span> <span class="st">"&lt;username&gt;/&lt;repository&gt;:&lt;tag&gt;"</span>)</a></code></pre></div>
<p>For ACR:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">env &lt;-<span class="st"> </span><span class="kw">r_environment</span>(<span class="st">"your-env-name"</span>,</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">                     <span class="dt">custom_docker_image =</span> <span class="st">"&lt;repository_name&gt;.azurecr.io/&lt;image_name&gt;:&lt;tag&gt;"</span>)</a></code></pre></div>
<p>If you want to use an image from a private container registry that is not in your workspace, you must specify the registry details using <a href="https://azure.github.io/azureml-sdk-for-r/reference/container_registry.html"><code>container_registry</code></a> and specify it to the <code>image_registry_details</code> parameter of <code>r_environment()</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">registry_details &lt;-<span class="st"> </span><span class="kw">container_registry</span>(<span class="dt">address =</span> <span class="st">"&lt;repository_name&gt;.azurecr.io"</span>,</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">                                       <span class="dt">username =</span> <span class="op">&lt;</span>repository_name<span class="op">&gt;</span>,</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">                                       <span class="dt">password =</span> <span class="op">&lt;</span>your password<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"></a>
<a class="sourceLine" id="cb14-5" data-line-number="5">env &lt;-<span class="st"> </span><span class="kw">r_environment</span>(<span class="st">"your-env-name"</span>,</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">                     <span class="dt">custom_docker_image =</span> <span class="st">"&lt;repository_name&gt;.azurecr.io/&lt;image_name&gt;:&lt;tag&gt;"</span>,</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">                     <span class="dt">image_registry_details =</span> registry_details)</a></code></pre></div>
</div>
<div id="use-the-custom-image-for-training" class="section level2">
<h2 class="hasAnchor">
<a href="#use-the-custom-image-for-training" class="anchor"></a>Use the custom image for training</h2>
<p>If you want to use your image for a remote training run, pass the environment you created into the estimator configuration for your job:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">ws &lt;-<span class="st"> </span><span class="kw">load_workspace_from_config</span>()</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"></a>
<a class="sourceLine" id="cb15-3" data-line-number="3">compute_target &lt;-<span class="st"> </span><span class="kw">get_compute</span>(ws, <span class="dt">cluster_name =</span> <span class="st">"your-cluster-name"</span>)</a>
<a class="sourceLine" id="cb15-4" data-line-number="4"></a>
<a class="sourceLine" id="cb15-5" data-line-number="5">exp &lt;-<span class="st"> </span><span class="kw">experiment</span>(<span class="dt">workspace =</span> ws, <span class="dt">name =</span> <span class="st">"your-experiment-name"</span>)</a>
<a class="sourceLine" id="cb15-6" data-line-number="6"></a>
<a class="sourceLine" id="cb15-7" data-line-number="7">est &lt;-<span class="st"> </span><span class="kw">estimator</span>(<span class="dt">source_directory =</span> <span class="st">"."</span>,</a>
<a class="sourceLine" id="cb15-8" data-line-number="8">                 <span class="dt">entry_script =</span> <span class="st">"train.R"</span>,</a>
<a class="sourceLine" id="cb15-9" data-line-number="9">                 <span class="dt">compute_target =</span> compute_target,</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">                 <span class="dt">environment =</span> env)</a>
<a class="sourceLine" id="cb15-11" data-line-number="11">                 </a>
<a class="sourceLine" id="cb15-12" data-line-number="12">run &lt;-<span class="st"> </span><span class="kw">submit_experiment</span>(exp, est)</a></code></pre></div>
</div>
<div id="use-the-custom-image-for-deployment" class="section level2">
<h2 class="hasAnchor">
<a href="#use-the-custom-image-for-deployment" class="anchor"></a>Use the custom image for deployment</h2>
<p>If you want to use the image for deploying a model as a web service, pass the environment you created into the inference configuration for your deployment:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">model &lt;-<span class="st"> </span><span class="kw">get_model</span>(ws, <span class="dt">name =</span> <span class="st">"your-model-name"</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">inference_config =<span class="st"> </span><span class="kw">inference_config</span>(<span class="dt">entry_script =</span> <span class="st">'score.R'</span>,</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">                                    <span class="dt">source_directory =</span><span class="st">'.'</span>,</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">                                    <span class="dt">environment =</span> env)</a>
<a class="sourceLine" id="cb16-5" data-line-number="5"></a>
<a class="sourceLine" id="cb16-6" data-line-number="6">aci_config &lt;-<span class="st"> </span><span class="kw">aci_webservice_deployment_config</span>(<span class="dt">cpu_cores =</span> <span class="dv">1</span>, <span class="dt">memory_gb =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb16-7" data-line-number="7"></a>
<a class="sourceLine" id="cb16-8" data-line-number="8">aci_service &lt;-<span class="st"> </span><span class="kw">deploy_model</span>(ws, </a>
<a class="sourceLine" id="cb16-9" data-line-number="9">                            <span class="st">'your-service-name'</span>,</a>
<a class="sourceLine" id="cb16-10" data-line-number="10">                            <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(model),</a>
<a class="sourceLine" id="cb16-11" data-line-number="11">                            inference_config,</a>
<a class="sourceLine" id="cb16-12" data-line-number="12">                            aci_config)</a></code></pre></div>
<p>For more information on deploying models in Azure ML, see the <a href="https://azure.github.io/azureml-sdk-for-r/articles/deploying-models.html">Deploying models</a> guide.</p>
</div>
<div id="additional-references" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-references" class="anchor"></a>Additional references</h2>
<p>For additional resources on building and using custom Docker images, you can refer to the following:</p>
<ul>
<li>
<a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">Best practices for writing Dockerfiles</a> - Official Docker documentation</li>
<li>
<a href="https://medium.com/microsoftazure/how-to-create-custom-docker-base-images-for-azure-machine-learning-environments-86aa4c7bc7b9">How to create custom Docker images for Azure Machine Learning Environments</a> - Microsoft Azure Medium blog post</li>
<li>
<a href="https://docs.microsoft.com/azure/machine-learning/how-to-deploy-custom-docker-image">Deploy a model using a custom Docker image</a> - Python SDK documentation, but core concepts still applicable</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#prerequisites">Prerequisites</a></li>
      <li><a href="#writing-the-dockerfile">Writing the Dockerfile</a></li>
      <li><a href="#build-and-publish-the-image">Build and publish the image</a></li>
      <li><a href="#create-an-azure-ml-environment">Create an Azure ML Environment</a></li>
      <li><a href="#use-the-custom-image-for-training">Use the custom image for training</a></li>
      <li><a href="#use-the-custom-image-for-deployment">Use the custom image for deployment</a></li>
      <li><a href="#additional-references">Additional references</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by AzureML R SDK Team, Microsoft.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
